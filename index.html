<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0">

    <title>Warframe Shopping List</title>

    <!-- PWA/Icons -->
    <link rel="manifest" href="/manifest.webmanifest">
    <meta name="theme-color" content="#005f73">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/icons/icon-512.png">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="shortcut icon" href="/favicon.svg"> <!-- optional -->

    <!-- Raleway font from Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/utilities.css">
    <link rel="stylesheet" href="css/media-queries.css">
    <link rel="stylesheet" href="css/dark-mode.css">
</head>

<body>
    <div class="container">
        <button class="btnMode" id="darkModeToggle" aria-label="Toggle dark mode" title="Toggle dark mode">ðŸŒ™</button>

        <header>
            <h1>Warframe Shopping List</h1>

            <div id="user-auth-area">
                <!-- User authentication UI will be rendered here by JS -->
            </div>
        </header>

        <!-- First-visit welcome banner (shown only for new users) -->
        <div id="welcome-banner" class="welcome-banner" hidden role="region" aria-label="Welcome banner">
            <div class="welcome-text">
                <strong>Welcome!</strong>
                <span>Start by creating a list, then search to add items.</span>
            </div>
            <button id="dismiss-welcome" class="button" aria-label="Dismiss welcome banner">Got it</button>
        </div>

        <div class="mobile-tabs" id="mobile-tabs">
            <button id="tab-items" class="tab-btn">Items</button>
            <button id="tab-lists" class="tab-btn active">Lists</button>
        </div>

        <div class="main-content">
            <!-- Item Search Container -->
            <div class="item-catalog" id="item-catalog-panel">
                <h2>Item Catalog</h2>

                <div class="filter-bar">
                    <small id="search-kbd-hint" class="kbd-hint" aria-hidden="true">Press / to focus, Esc to clear</small>
                    <div class="search-filter">
                        <input type="text" id="globalSearch" placeholder="Search for items..." aria-describedby="search-kbd-hint" title="Press / to focus, Esc to clear">

                        <select aria-label="Category filter" id="category-filter">
                            <option value="">All Categories</option>
                        </select>

                        <button class="button" id="clearSearch" style="display:none" aria-label="Clear search" title="Clear search (Esc)">Clear</button>
                    </div>
                </div>

                <ul id="item-list"></ul>
            </div>

            <!-- Shopping Lists Container -->
            <div class="shopping-lists" id="shopping-lists-panel">
                <h2>Shopping List <span id="active-list-name"></span></h2>

                <div class="create-list">
                    <input type="text" id="new-list-name" placeholder="New list name...">

                    <div class="action-buttons">
                        <button class="button" id="create-list-btn">Create List</button>
                        <button class="button" id="clear-list-btn">Clear List</button>
                        <button class="button danger" id="delete-list-btn">Delete List</button>
                    </div>
                </div>

                <ul id="shopping-list-tabs"></ul>

                <div class="list-switcher" id="list-switcher" hidden>
                    <label for="list-select"><strong>Active list</strong></label>
                    <select id="list-select" aria-label="Active list"></select>
                </div>

                <div class="list-sticky-bar" aria-live="polite">
                    <div class="list-sticky-summary">
                        <div id="total-cost" class="total"></div>
                        <span id="price-warning" class="muted"></span>
                    </div>

                    <div class="list-sticky-cta">
                        <button class="button" id="check-prices-btn">Check Prices</button>
                    </div>
                </div>

                <div class="shopping-list">
                    <div id="shopping-list-content"></div>
                </div>

                <div id="prices-summary">
                    <div id="prices-head">
                        <h3>Prices</h3>

                        <div class="sort-control">
                            <label for="prices-group-mode">Group prices by: </label>
                            <select id="prices-group-mode">
                                <option value="seller">Seller</option>
                                <option value="item">Item</option>
                            </select>
                        </div>
                    </div>

                    <div id="prices-breakdown"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- New List Name Dialog -->
    <dialog id="new-list-dialog" aria-labelledby="new-list-title">
        <form id="new-list-form" method="dialog" class="new-list-form">
            <h3 id="new-list-title">Create new list</h3>

            <label for="new-list-name-modal" class="visually-hidden">List name</label>
            <input id="new-list-name-modal" type="text" placeholder="List nameâ€¦" required>

            <div class="dialog-actions">
                <button type="button" class="button ghost" id="new-list-cancel">Cancel</button>
                <button type="submit" class="button">Create</button>
            </div>
        </form>
    </dialog>

    <script type="module">
        import { initDomUtils } from './js/modules/domUtils.js';
        import './js/app.js';
        initDomUtils();
    </script>
</body>
</html>
